**参考链接：[ES6入门-阮一峰](/FrontEnd/JS/)**

笔记补充中...

------

`var`的问题：

1. 重复声明
2. 无法定义常量
3. 块级作用域

#### 1.变量

##### 1.1新的声明方法

`let`: 不可重复声明、块级作用域

`const`: 常量、块级作用域

```js
<input type="button" value="a">
<input type="button" value="b">
<input type="button" value="c">

// js
// 这样不行,各个按钮显示的i都是3
let aBtn = document.getElementsByTagName('input');
for (var i = 0; i < aBtn.length; i++) {
    aBtn[i].onclick = function() {
        console.log(i);
    }
}

// 用之前常用的index解决
let aBtn = document.getElementsByTagName('input');
for (var i = 0; i < aBtn.length; i++) {
    aBtn[i].index = i;
    aBtn[i].onclick = function () {
        console.log(this.index);
    }
}
// 闭包解决
let aBtn = document.getElementsByTagName('input');
for (var i = 0; i < aBtn.length; i++) {
    (function (k) {
        aBtn[k].onclick = function () {
            console.log(k);
        }
    })(i);
}
```

现在有了`let`后可以很方便的解决

```js
let aBtn = document.getElementsByTagName('input');
for (let i = 0; i < aBtn.length; i++) {
    aBtn[i].onclick = function () {
        console.log(i);
    }
}
```

上述详解：

ES5中`var`的作用域——函数级

ES6中`let`作用域——块级`{}`（`for`, `if`都是代码块）

`var`加函数解决和`let`解决方式类似，`var`加函数就对应`i`创建了几个函数；而`let`的在循环过程中创建`i`个块。

##### 2.2解构赋值

适合从大的数据中取值。使用注意：

1. 两边结构必须一样
2. 赋值和解构同时完成

```js
// 给a,b赋值
json = {a: 12, b: 5};
let {a,b} = json;

arr = [12, 3, 4];
let [a,b,c] = arr;

// 可以用来从Ajax中取出数据
let {code,data} = $.ajax('xxx');
```

##### 2.3块级作用域

替代闭包（这里不太理解，后面再补上）

#### 2.函数

##### 2.1箭头函数

1. 为了写函数方便。使用注意：

   - 如果有且仅有一个参数，`()`也可不写

   - 如果有且仅有一个语句并且是`return`，`{}`可不写

```js
function() {
    // some code
}

// 上述改为箭头函数
()=>{}
```

```js
let arr = [1, 3, 4, 7];
arr.sort((n1, n2)=>{return n1-n2;});
```

2. 可以固定`this`。将`this`的指向固定在**定义**处。除非使用`call`, `apply`, `bind`更改 

```js
class Json {
    constructor() {
        this.a = 12;
        this.fn = ()=>{
            console.log(this.a);
        };
    }
}
let json = new Json();
let oDate = new Date();
oDate.fn = json.fn;
oDate.fn();// 12
```

##### 2.2参数展开、数组展开、Json展开

`...参数`相当于把数字掏出来。

用来收集参数，为一个数组。必须放最后

```js
function show(a, b, ...c) {
    console.log(a, b, c);
}
show(12, 3, 4, 5, 6);// 12 3 [ 4, 5, 6 ]
```

参数展开

```js
let arr = [12, 5, 5];

//...arr1  相当于把数字掏出来 12, 5, 5
function show(a, b, c) {
    console.log(a, b, c);
}
show(arr); //[12, 5, 5]
show(...arr); // 12 5 5
```

数组展开（用`concat`也能实现）

```js
let arr1 = [1, 2];
let arr2 = [3, 4];
let arr3 = [...arr1, ...arr2];// [1, 2, 3, 4]
```

Json展开

```js
let json1 = {a: 1, b: 2};
let json2 = {
    ...json1,
    c: 3;
}
// {a: 1, b: 2, c: 3}
```

#### 3.原生对象扩展

##### 3.1Array扩展

`map`、`reduce`、`filter`、`forEach`

`map`：映射，一一对应。（进去多少个，出来多少个）

`reduce`：n=>1。（进去多少个，出来一个）

`filter`：过滤。（进去多少个，出来n个）

`forEach`：遍历

```js
// map
let arr = [54, 56, 61];
let arr2 = arr.map((item)=>{return item>=60?'及格':'不及格'});
console.log(arr2); // [ "不及格", "不及格", "及格" ]

// reduce
let arr = [54, 56, 61];
// reduce 语法
let result = arr.reduce(function(tmp, item, index) {return tmp + item;});

//reduce求平均数
let result = arr.reduce(function(tmp, item, index) {
    if (index === arr.length - 1) {
        // 最后一次求和时候返回平均值
        return (tmp + item) / arr.length;
    }
    else {
        return tmp + item;
    }
})

// filter使用,保留偶数
let arr2 = arr.filter((item)=>{return item % 2 === 0;})

// forEach
arr.forEach((item, index)=>{
    console.log(index + ':' + item);
})
```

##### 3.2模板字符串

为了书写方便，替换字符串拼接，用`${variable}`替代，并用反单引号包起来

```js
console.log('第' + index + '个：' + item);
// 等效

console.log(`第${index}个：${item}`)
```

##### 3.3Json写法

一个把字符串变JSON，一个把JSON变字符串

`JSON.stringify({a: 12, b: 5})` => `'{"a": 12, "b": 5}'`

`JSON.parse('{"a": 12, "b": 5}')` => `{a: 12, b: 5}`