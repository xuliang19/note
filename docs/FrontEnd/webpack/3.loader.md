#### 1. loader介绍

[loader](https://www.webpackjs.com/concepts/#loader)

**loader就是一个打包方案**，从下面这个简单例子来理解loader：

当index.js需要引入图片时候：

```js
// index.js
import avatar from './avatar.jpg';

var img = new Image();
img.src = avatar;

var root  = doucment.getElementById('root');
root.append(img);
```

webpack默认只可以给JS文件打包，要给图片文件打包要进行以下几步：

1. 先安装file-loader

   > npm install file-loader -D

2. 修改webpack配置文件

   ```js
   const path = require('path');
   
   module.exports = {
       mode: 'development',
       // 之前的entry是简写
       entry: {
           main: './src/index.js'
       },
       module: {
           rules: [{
               test: /\.jpg$/,
               use: [{
                   loader: 'file-loader'
               }]
           }]
       },
       output: {
           filename: 'bundle.js',
           path: path.resolve(__dirname, 'dist')
       }
   }
   ```

3. webpack打包

   > npm run bundle

打包完后的图片名为*d0f47785fc2bb6101c2f557c9c8bb827.jpg*。一个哈希值

#### 2. 打包图片类资源

##### 2.1 file-loader

[file-loader](https://www.webpackjs.com/loaders/file-loader/)

下面介绍如何修改打包后图片名称，图片输出路径

```js
const path = require('path');

module.exports = {
    mode: 'development',
    // 之前的entry是简写
    entry: {
        main: './src/index.js'
    },
    module: {
        rules: [{
            test: /\.jpg$/,
            use: [{
                loader: 'file-loader',
                options: {
                    // 使用原文件名,原文件后缀
                    // 占位符 placeholders
                    // 也可 name: '[name]_[hash].[ext]'
                    name: '[name].[ext]',
                    // 打包路径
                    outputPath: 'images/'
                }
            }]
        }]
    },
    output: {
        filename: 'bundle.js',
        path: path.resolve(__dirname, 'dist')
    }
}
```

##### 2.2 url-loader

[url-loader](https://www.webpackjs.com/loaders/url-loader/)

先和file-loader一样安装url-loader

> npm install url-loader -D

```js
const path = require('path');

module.exports = {
    mode: 'development',
    // 之前的entry是简写
    entry: {
        main: './src/index.js'
    },
    module: {
        rules: [{
            test: /\.jpg|png|gif$/,
            use: [{
                // 更改为url-loader
                loader: 'url-loader',
                options: {
                    name: '[name].[ext]',
                    outputPath: 'images/'
                }
            }]
        }]
    },
    output: {
        filename: 'bundle.js',
        path: path.resolve(__dirname, 'dist')
    }
}
```

图片不会打包过去，它会将图片转化为一个*base64*的字符串，然后直接放到bundle.js中。用处：如果图片很小，就是使用url-loader；图片很大，就用file-loader。

可以设置一个选项来设置临界大小

```js
// ...
module: {
    rules: [{
        test: /\.jpg$/,
        use: [{
            loader: 'url-loader',
            options: {
                name: '[name].[ext]',
                outputPath: 'images/',
                // 限制204800个字节大小,不符合就会直接打包过去
                limit: 204800
            }
        }]
    }]
}
// ...
```



#### 3. 打包CSS样式

##### 3.1 打包原生CSS样式

1. 先安装css-loader、style-loader

   > npm install css-loader style-loader -D

2. 更改webpack配置

   ```js
   // ...
   module: {
       rules: [{
           test: /\.jpg$/,
           use: [{
               loader: 'file-loader',
               options: {
                   name: '[name].[ext]',
                   outputPath: 'images/'
               }
           }]
       }, {
           test: /\.css$/,
           use: [{
               loader: ['css-loader', 'style-loader']
           }]
       }]
   }
   // ...
   ```

3. index.js引入样式

   ```js
   // index.js
   import avatar from './avatar.jpg';
   import './index.css';
   
   var img = new Image();
   img.src = avatar;
   img.classList.add('avatar');
   
   var root  = doucment.getElementById('root');
   root.append(img);
   ```

   ```css
   /* index.css */
   .avatar {
       width: 150px;
   }
   ```

   